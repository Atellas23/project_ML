\documentclass[10pt]{article}

\usepackage{amsmath}                                                                % Math mode $-$ o $$-$$
\usepackage{amssymb}                                                                % Mathematic symbols
\usepackage{mathrsfs}                                                               % Caligraphic letters
\usepackage{amsthm}                                                                 % Theorem-like environments

\usepackage[english]{babel}                                                         % Language (it is important when hyphenating words)
\usepackage[utf8]{inputenc}                                                         % Accented letters and other strange symbols

\usepackage{graphicx}                                                               % Images
\usepackage{float}                                                                  % Puts images where they belong
\usepackage{subcaption}                                                             % Subimages
\usepackage{wrapfig}                                                                % Text and image on the same line
\usepackage{subfiles}                                                               % Subfiles
\usepackage[hidelinks]{hyperref}                                                    % Allows external and internal references
\usepackage[nameinlink]{cleveref}                                                   % Improves internal references
\usepackage[super,square]{natbib}                                                   % Easy bibliography

\usepackage{verbatim}                                                               % Verbatim + multiline comments
\usepackage{anysize}\marginsize{2cm}{2cm}{.5cm}{4cm}                                % Personalizes margins: {L}{R}{U}{D}
\usepackage{bbm}                                                                    % Allows \1
\usepackage{mathdots}                                                               % Rising triple dot symbol
\usepackage{faktor}                                                                 % Fancy rendering of coset sets
\usepackage{tikz-cd}                                                                % Commutative diagrams
\usetikzlibrary{babel}                                                              % Avoids interference between tikz-cd i babel
\usepackage{lipsum}                                                                 % Lorem ipsum dolor sit amet, with \lipsum or \lipsum[1]
\usepackage{todonotes}                                                              % To indicate something is missing
\usepackage[normalem]{ulem}


\usepackage{amsthm}
\usepackage{xcolor}
\usepackage{tcolorbox}
\newtcbox{\mybox}{on line,
  colframe=blue,colback=blue!10!white,
  boxrule=0.5pt,arc=4pt,boxsep=0pt,left=6pt,right=6pt,top=6pt,bottom=6pt}

\usepackage{hyperref}
\hypersetup{
    colorlinks = true,
    filecolor = blue,
    linkcolor = blue,
    urlcolor = blue,
}

\thispagestyle{empty}

\begin{document}
\begingroup
  \centering
  \Huge Machine Learning 1\\
  \vskip 0.5cm
  \LARGE Solved Problems\\[1.5em]
\endgroup

\section{Team members:}
\begin{itemize}
  \item Luis Sierra Muntané (luis.sierra@est.fib.upc.edu)
  \item Àlex Batlle Casellas (alex.batlle@est.fib.upc.edu)
  \item Aleix Torres i Camps (aleix.torres.camps@est.fib.upc.edu)
\end{itemize}
\vskip 0.3cm

\section{Problems}
\begin{enumerate}
  \item You may need the following procedures for several exercises below.
  \begin{enumerate}
    \item[(a)] Write a procedure to generate random samples according to a normal distribution $\mathcal N(\boldmath\mu,\boldmath\Sigma)$ in $d$ dimensions.\\
        {\scshape Solution:}\\
        Based on the information in Wikipedia's Multivariate Normal Distribution page, and in particular in \href{https://en.wikipedia.org/wiki/Multivariate_normal_distribution#Normal_random_vector}{this part}, we see that a $d-$dimensional vector $X$ is normally distributed (it is a \textit{normal random vector}) iff there exist a vector $\mu$, a matrix $A$ of coefficients and a standard normal vector $Z$ (meaning, it follows a standard normal distribution and the components are independent) such that $AZ + \mu = X$, with the covariance matrix being $\Sigma=AA^T$. So, we will take advantage of all this situation:
        \begin{itemize}
          \item We can calculate the matrix $A$ by simply decomposing $\Sigma$ (which is the matrix we are given) using the Cholesky decomposition method, which factors a symmetric positive-definite matrix into a product of a lower triangular matrix and its transpose. R has a built in function named \verb|chol|, although this gives the upper triangular part of the decomposition.
          \item We just have to calculate a random vector $Z$, and we will do so using the function \verb|rnorm| already included in R.
          \item The reason we are not doing this straight away is because of $\Sigma$: if it is the identity matrix, or a multiple of the identity $\sigma^2I_d$, we could easily get a normally distributed $d-$dimensional vector by using \verb|rnorm(d, mu, sigma)|, but as this is not necessarily the case and there could be positive covariance between the components, we have to think another way of working.
        \end{itemize}
        So, the solution code is this one:
        \begin{verbatim}
normal = function(mu, sigma) {
    d = length(mu)
    L = t(chol(sigma))
    res = rnorm(d)
    return(L %*% res + mu)
}
        \end{verbatim}
    \item[(b)] Write a procedure to calculate the discriminant function (of the form given in Eq. 47) for a given normal distribution and prior probability $P(\omega_i)$.\\
        {\scshape Solution:}\\
        We will suppose we are given the probability of class $i$, and the $\mu_i,\Sigma_i$ such that $p(x|\omega_i)\sim\mathcal N(\mu_i,\Sigma_i)$. Given the formula in Eq. 47,
        \[
g_i(\boldsymbol x)=-\frac{1}{2}(\boldsymbol x-\boldsymbol\mu_i)^T\boldsymbol\Sigma_i^{-1}(\boldsymbol x-\boldsymbol\mu_i)-\frac{d}{2}\ln{2\pi}-\frac{1}{2}\ln{\det{\boldsymbol\Sigma_i}}+\ln{P(\omega_i)},
        \]
        the implementation is quite straight forward:
        \begin{verbatim}
calc_discr = function(x, p, mu, sigma) {
  xnorm = x - mu
  inv = solve(sigma)
  d = length(mu)
  dt = det(sigma)
  return(-0.5*t(xnorm)%*%inv%*%xnorm-d/2*log(2*pi)-0.5*log(dt)+log(p))
}
        \end{verbatim}
        We are using the function \verb|solve|, which R has built-in, that solves linear systems given $A,b$ such that $Ax=b$. If $b$ is absent, the function returns the inverse of a matrix.
    \item[(c)] Write a procedure to calculate the Euclidean distance between two arbitrary points.\\
        {\scshape Solution:}\\
        We will write the solution for the general $p-$norm distance:
        \begin{verbatim}
# pre: length(x)=length(y)
euc = function(x, y, p = 2) {
  n = length(x)
  sum = 0
  for (i in 1:n) {
    sum = sum + abs(x[i]-y[i])^p
  }
  return(sum^(1/p))
}
        \end{verbatim}
        Note that we could have also used the \verb|dist| function included in R, by row-binding the coordinates of $x$ and $y$ into a matrix.
    \item[(d)] Write a procedure to calculate the Mahalanobis distance between the mean $\mu$ and an arbitrary point $x$, given the covariance matrix.\\
        {\scshape Solution:}\\
        We will be using the matrix formula for the Mahalanobis distance, which is the square root of a quadratic form, namely
        \[
        \delta_M(x,y)=\sqrt{(x-y)^T\Sigma^{-1}(x-y)}.
        \]
        \begin{verbatim}
mah = function(x, mu, sigma) {
    xnorm = x - mu
    return(sqrt(t(xnorm)%*%solve(sigma)%*%xnorm))
}
        \end{verbatim}
  \end{enumerate}
\end{enumerate}

\end{document} 